\doxysection{audio\+\_\+engine.\+hpp}
\hypertarget{audio__engine_8hpp_source}{}\label{audio__engine_8hpp_source}\index{src/engine/audio\_engine.hpp@{src/engine/audio\_engine.hpp}}
\doxymbox{\hyperlink{audio__engine_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ AUDIO\_ENGINE\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ AUDIO\_ENGINE\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{audio__node_8hpp}{audio\_node.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{flux__graph_8hpp}{flux\_graph.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{render__plan_8hpp}{render\_plan.hpp}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{master__node_8hpp}{master\_node.hpp}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{input__node_8hpp}{input\_node.hpp}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{automation_8hpp}{../session/automation.hpp}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <SDL3/SDL.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <atomic>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{namespace\ }\doxymbox{\hyperlink{namespace_beam}{Beam}}\ \{}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{class_beam_1_1_audio_engine_a984cb2c1c5cae9f6a44be879582791e8}{AudioEngine}}\ \{}
\DoxyCodeLine{00018\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00019\ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a984cb2c1c5cae9f6a44be879582791e8}{AudioEngine}}();}
\DoxyCodeLine{00020\ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ae6cd4742fe2edcfaea839dc12e0cd2c7}{\string~AudioEngine}}();}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordtype}{bool}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a40bd3aa14641b3b4a876385143363331}{init}}(\textcolor{keywordtype}{int}\ sampleRate,\ \textcolor{keywordtype}{int}\ channels,\ \textcolor{keyword}{const}\ std::string\&\ outputDevice\ =\ \textcolor{stringliteral}{"{}"{}},\ \textcolor{keyword}{const}\ std::string\&\ inputDevice\ =\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00023\ \ \ \ \ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{//\ Called\ from\ audio\ thread\ (or\ main\ loop),\ lock-\/free}}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ad642b2c703847dc3fd52a4d203083a9a}{process}}(\textcolor{keywordtype}{float}*\ output,\ \textcolor{keywordtype}{int}\ frames,\ \textcolor{keyword}{const}\ \doxymbox{\hyperlink{class_beam_1_1_m_i_d_i_buffer}{MIDIBuffer}}\&\ midi\ =\ \doxymbox{\hyperlink{class_beam_1_1_m_i_d_i_buffer}{MIDIBuffer}}());}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{//\ Called\ from\ UI\ thread\ to\ update\ the\ active\ processing\ plan}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_aedbcbbb422a975217cfafc22cfd17b0c}{setGraph}}(std::shared\_ptr<FluxGraph>\ graph);}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a187ee5fe9db7ee32b9389bba38231721}{updatePlan}}();}
\DoxyCodeLine{00030\ \ \ \ \ }
\DoxyCodeLine{00031\ \ \ \ \ std::shared\_ptr<FluxGraph>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a96a0cdd7ef2b6d89fbae82122caa849d}{getGraph}}()\ \{\ \textcolor{keywordflow}{return}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ac35c02a04d9c946a264c735485bfa611}{m\_graph}};\ \}}
\DoxyCodeLine{00032\ \ \ \ \ std::shared\_ptr<MasterNode>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_af89b35f3399cb0780e8a7d7755e13888}{getMasterNode}}()\ \{\ \textcolor{keywordflow}{return}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a8831b1803efa6ae4ae6a060b3de0e30a}{m\_masterNode}};\ \}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a7b40e0830210096ecb44349c5e27a18c}{setPlaying}}(\textcolor{keywordtype}{bool}\ playing);}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordtype}{bool}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a456e847f34fbc934900413639850f924}{isPlaying}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a5ace65ddbdaf0088334c2f48acd17655}{m\_isPlaying}};\ \}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a34e5112ab4743e510754758353a66a9f}{rewind}}();}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a6ce1614fcfed84b35531339021bae331}{seek}}(\textcolor{keywordtype}{size\_t}\ frame);}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a2dd6515d6063f135b8982c8df5243f40}{getCurrentFrame}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a675a3c69d2b72f1d78e4801003671bb3}{m\_currentFrame}};\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a039d3080ee997f1fcf7ea4e102188a52}{addAutomationLane}}(std::shared\_ptr<AutomationLane>\ lane)\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ac960845317ae55dbffbf2e7c1f4176ce}{m\_automationLanes}}.push\_back(lane);}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ std::shared\_ptr<InputNode>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a9437a6b4e21e3a59aa4410b51e5c7009}{getInputNode}}()\ \{\ \textcolor{keywordflow}{return}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a746bbf6112555cda830730f476c804a8}{m\_inputNode}};\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a675a3c69d2b72f1d78e4801003671bb3}{m\_currentFrame}}\ =\ 0;}
\DoxyCodeLine{00049\ \ \ \ \ std::vector<std::shared\_ptr<AutomationLane>>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ac960845317ae55dbffbf2e7c1f4176ce}{m\_automationLanes}};}
\DoxyCodeLine{00050\ \ \ \ \ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{int}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_abeb2228b0d0a09fac76834dda57ad5ab}{m\_sampleRate}};}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{int}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a28eb68f5efd3038d4da2a65da3bb5181}{m\_channels}};}
\DoxyCodeLine{00053\ \ \ \ \ }
\DoxyCodeLine{00054\ \ \ \ \ std::shared\_ptr<FluxGraph>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ac35c02a04d9c946a264c735485bfa611}{m\_graph}};\ \textcolor{comment}{//\ "{}Model"{}\ graph\ (UI\ thread)}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a86ed2fef95c106eaa6631713105a3e4a}{m\_masterNodeId}};}
\DoxyCodeLine{00056\ \ \ \ \ std::shared\_ptr<MasterNode>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a8831b1803efa6ae4ae6a060b3de0e30a}{m\_masterNode}};}
\DoxyCodeLine{00057\ \ \ \ \ std::shared\_ptr<InputNode>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a746bbf6112555cda830730f476c804a8}{m\_inputNode}};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ The\ active\ plan\ used\ by\ the\ audio\ thread.\ }}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//\ Atomic\ shared\_ptr\ allows\ lock-\/free\ swapping.}}
\DoxyCodeLine{00061\ \ \ \ \ std::atomic<std::shared\_ptr<RenderPlan>>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_af72266c72bc4ad57a1bb0213d6eb385e}{m\_activePlan}};}
\DoxyCodeLine{00062\ \ \ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ SDL\_AudioStream*\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a1792387f3723d0e1683aba783aef5fe4}{m\_stream}};}
\DoxyCodeLine{00064\ \ \ \ \ SDL\_AudioStream*\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_ab15ab6e72be8471f4ac53b3493e15cc4}{m\_captureStream}};}
\DoxyCodeLine{00065\ \ \ \ \ std::atomic<bool>\ \doxymbox{\hyperlink{class_beam_1_1_audio_engine_a5ace65ddbdaf0088334c2f48acd17655}{m\_isPlaying}}\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00066\ \};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \}\ \textcolor{comment}{//\ namespace\ Beam}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ AUDIO\_ENGINE\_HPP}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ }

\end{DoxyCode}
