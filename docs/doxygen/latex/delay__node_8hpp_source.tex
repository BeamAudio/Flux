\doxysection{delay\+\_\+node.\+hpp}
\hypertarget{delay__node_8hpp_source}{}\label{delay__node_8hpp_source}\index{src/dsp/delay\_node.hpp@{src/dsp/delay\_node.hpp}}
\doxymbox{\hyperlink{delay__node_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ DELAY\_NODE\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ DELAY\_NODE\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{audio__node_8hpp}{audio\_node.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{keyword}{namespace\ }\doxymbox{\hyperlink{namespace_beam}{Beam}}\ \{}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{class_beam_1_1_delay_node_af4f9dc6cc6e26c7bb963f17c85c3858c}{DelayNode}}\ :\ \textcolor{keyword}{public}\ \doxymbox{\hyperlink{class_beam_1_1_audio_node}{AudioNode}}\ \{}
\DoxyCodeLine{00010\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00011\ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_af4f9dc6cc6e26c7bb963f17c85c3858c}{DelayNode}}(\textcolor{keywordtype}{float}\ delaySeconds,\ \textcolor{keywordtype}{float}\ feedback,\ \textcolor{keywordtype}{float}\ sampleRate)\ }
\DoxyCodeLine{00012\ \ \ \ \ \ \ \ \ :\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}}(feedback),\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a00520ac5853ff38e3f68cd5c64d635b2}{m\_sampleRate}}(sampleRate),\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}(0)\ \{}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ delaySamples\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(delaySeconds\ *\ sampleRate);}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}.resize(delaySamples\ *\ 2,\ 0.0f);\ \textcolor{comment}{//\ Stereo\ buffer}}
\DoxyCodeLine{00015\ \ \ \ \ \}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a1f946e80326aaaf6dc87e6ec4e4b1858}{process}}(\textcolor{keywordtype}{float}*\ buffer,\ \textcolor{keywordtype}{int}\ frames,\ \textcolor{keywordtype}{int}\ channels)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (channels\ !=\ 2)\ \textcolor{keywordflow}{return};\ \textcolor{comment}{//\ Simple\ stereo\ implementation}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ frames;\ ++i)\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ channels;\ ++c)\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ idx\ =\ i\ *\ channels\ +\ c;}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ delayedSample\ =\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}[\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}];}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ inputSample\ =\ buffer[idx];}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer[idx]\ +=\ delayedSample;}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}[\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}]\ =\ inputSample\ +\ delayedSample\ *\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}};}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}++;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}\ >=\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}.size())\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}\ =\ 0;}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ std::string\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aac469a6ff6f2ea95f5ffbb06f60dbf2e}{getName}}()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Delay"{}};\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00039\ \ \ \ \ std::vector<float>\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}};}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}};}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a00520ac5853ff38e3f68cd5c64d635b2}{m\_sampleRate}};}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}};}
\DoxyCodeLine{00043\ \};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \}\ \textcolor{comment}{//\ namespace\ Beam}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ DELAY\_NODE\_HPP}}

\end{DoxyCode}
