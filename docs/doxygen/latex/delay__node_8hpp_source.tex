\doxysection{delay\+\_\+node.\+hpp}
\hypertarget{delay__node_8hpp_source}{}\label{delay__node_8hpp_source}\index{src/engine/delay\_node.hpp@{src/engine/delay\_node.hpp}}
\doxymbox{\hyperlink{delay__node_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ DELAY\_NODE\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ DELAY\_NODE\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{audio__node_8hpp}{audio\_node.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\doxymbox{\hyperlink{dsp__utils_8hpp}{dsp\_utils.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{namespace\ }\doxymbox{\hyperlink{namespace_beam}{Beam}}\ \{}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{class_beam_1_1_delay_node_af4f9dc6cc6e26c7bb963f17c85c3858c}{DelayNode}}\ :\ \textcolor{keyword}{public}\ \doxymbox{\hyperlink{class_beam_1_1_audio_node}{AudioNode}}\ \{}
\DoxyCodeLine{00011\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00012\ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_af4f9dc6cc6e26c7bb963f17c85c3858c}{DelayNode}}(\textcolor{keywordtype}{float}\ delaySeconds,\ \textcolor{keywordtype}{float}\ feedback,\ \textcolor{keywordtype}{float}\ sampleRate)\ }
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ :\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}}(feedback),\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a00520ac5853ff38e3f68cd5c64d635b2}{m\_sampleRate}}(sampleRate),\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}(0)\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ delaySamples\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(delaySeconds\ *\ sampleRate);}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}.resize(delaySamples\ *\ 2,\ 0.0f);\ \textcolor{comment}{//\ Stereo\ buffer}}
\DoxyCodeLine{00016\ \ \ \ \ \}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keywordtype}{void}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a44fdc2abfe4112bf5e89f97d1c9ebe20}{process}}(\textcolor{keywordtype}{float}*\ buffer,\ \textcolor{keywordtype}{int}\ frames,\ \textcolor{keywordtype}{int}\ channels,\ \textcolor{keywordtype}{size\_t}\ startFrame\ =\ 0)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ frames;\ ++i)\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ channels;\ ++c)\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ idx\ =\ i\ *\ channels\ +\ c;}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ delayedSample\ =\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}[\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}];}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ inputSample\ =\ buffer[idx];}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buffer[idx]\ +=\ delayedSample;}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}[\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}]\ =\ \doxymbox{\hyperlink{namespace_beam_aa7334dd3aa681f0530ad4fdc9b379103}{flush\_denormal}}(inputSample\ +\ delayedSample\ *\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}});}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}++;}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}\ >=\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}}.size())\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}}\ =\ 0;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ std::string\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aac469a6ff6f2ea95f5ffbb06f60dbf2e}{getName}}()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Delay"{}};\ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00038\ \ \ \ \ std::vector<float>\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a5b84198373b6956ed0a207cff4bbe89e}{m\_buffer}};}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_aea926261f1f2685e8e626cad0eff131b}{m\_feedback}};}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{float}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a00520ac5853ff38e3f68cd5c64d635b2}{m\_sampleRate}};}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \doxymbox{\hyperlink{class_beam_1_1_delay_node_a418ca0782552901f5dc8b8910ea9e809}{m\_writePtr}};}
\DoxyCodeLine{00042\ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \}\ \textcolor{comment}{//\ namespace\ Beam}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ DELAY\_NODE\_HPP}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ }

\end{DoxyCode}
