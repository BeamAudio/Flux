\doxysection{wav\+\_\+writer.\+hpp}
\hypertarget{wav__writer_8hpp_source}{}\label{wav__writer_8hpp_source}\index{src/dsp/wav\_writer.hpp@{src/dsp/wav\_writer.hpp}}
\doxymbox{\hyperlink{wav__writer_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{namespace\ }\doxymbox{\hyperlink{namespace_beam}{Beam}}\ \{}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{class\ }\doxymbox{\hyperlink{class_beam_1_1_wav_writer}{WavWriter}}\ \{}
\DoxyCodeLine{00009\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00010\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \doxymbox{\hyperlink{class_beam_1_1_wav_writer_a907da59c59b79311cbe891d78c12ce6e}{write}}(\textcolor{keyword}{const}\ std::string\&\ filename,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}*\ buffer,\ \textcolor{keywordtype}{size\_t}\ numSamples,\ \textcolor{keywordtype}{int}\ sampleRate,\ \textcolor{keywordtype}{int}\ channels)\ \{}
\DoxyCodeLine{00011\ \ \ \ \ \ \ \ \ std::ofstream\ file(filename,\ std::ios::binary);}
\DoxyCodeLine{00012\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!file.is\_open())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ RIFF\ header}}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ file.write(\textcolor{stringliteral}{"{}RIFF"{}},\ 4);}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ int32\_t\ fileSize\ =\ 36\ +\ numSamples\ *\ \textcolor{keyword}{sizeof}(int16\_t);}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&fileSize),\ 4);}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ file.write(\textcolor{stringliteral}{"{}WAVE"{}},\ 4);}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fmt\ chunk}}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ file.write(\textcolor{stringliteral}{"{}fmt\ "{}},\ 4);}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ int32\_t\ fmtSize\ =\ 16;}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&fmtSize),\ 4);}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ int16\_t\ format\ =\ 1;\ \textcolor{comment}{//\ PCM}}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&format),\ 2);}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ int16\_t\ numChannels\ =\ \textcolor{keyword}{static\_cast<}int16\_t\textcolor{keyword}{>}(channels);}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&numChannels),\ 2);}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ int32\_t\ sRate\ =\ sampleRate;}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&sRate),\ 4);}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ int32\_t\ byteRate\ =\ sampleRate\ *\ channels\ *\ \textcolor{keyword}{sizeof}(int16\_t);}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&byteRate),\ 4);}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ int16\_t\ blockAlign\ =\ channels\ *\ \textcolor{keyword}{sizeof}(int16\_t);}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&blockAlign),\ 2);}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ int16\_t\ bitsPerSample\ =\ 16;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&bitsPerSample),\ 2);}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ data\ chunk}}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ file.write(\textcolor{stringliteral}{"{}data"{}},\ 4);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ int32\_t\ dataSize\ =\ numSamples\ *\ \textcolor{keyword}{sizeof}(int16\_t);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&dataSize),\ 4);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ numSamples;\ ++i)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ sample\ =\ buffer[i];}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sample\ >\ 1.0f)\ sample\ =\ 1.0f;}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sample\ <\ -\/1.0f)\ sample\ =\ -\/1.0f;}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ intSample\ =\ \textcolor{keyword}{static\_cast<}int16\_t\textcolor{keyword}{>}(sample\ *\ 32767.0f);}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ file.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&intSample),\ 2);}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00051\ \ \ \ \ \}}
\DoxyCodeLine{00052\ \};}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \}\ \textcolor{comment}{//\ namespace\ Beam}}

\end{DoxyCode}
